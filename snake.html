<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>Gemini è²ªé£Ÿè›‡</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #222; /* æ·±è‰²èƒŒæ™¯ */
            color: white;
            font-family: 'Arial', sans-serif;
        }
        h1 {
            margin-top: 0;
            font-size: 24px;
            color: #4CAF50;
        }
        canvas {
            border: 4px solid #fff;
            background-color: #000;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
        }
        .score-board {
            margin: 10px 0;
            font-size: 20px;
        }
        .instructions {
            font-size: 14px;
            color: #aaa;
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <h1>ğŸ Gemini è²ªé£Ÿè›‡</h1>
    <div class="score-board">å¾—åˆ†: <span id="score">0</span></div>
    
    <canvas id="gameCanvas" width="400" height="400"></canvas>

    <div class="instructions">
        ä½¿ç”¨éµç›¤ â¬†ï¸ â¬‡ï¸ â¬…ï¸ â¡ï¸ æ§åˆ¶æ–¹å‘<br>
        æ’ç‰†æˆ–æ’åˆ°è‡ªå·±å‰‡éŠæˆ²çµæŸ
    </div>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        // è¨­å®šæ ¼å­çš„å–®ä½å¤§å°
        const box = 20;
        const canvasSize = 400; // 400/20 = 20æ ¼

        // è›‡çš„èº«é«” (åˆå§‹åœ¨ä¸­é–“)
        let snake = [];
        snake[0] = { x: 10 * box, y: 10 * box };

        // é£Ÿç‰©ä½ç½® (éš¨æ©Ÿ)
        let food = {
            x: Math.floor(Math.random() * (canvasSize/box)) * box,
            y: Math.floor(Math.random() * (canvasSize/box)) * box
        };

        // åˆ†æ•¸
        let score = 0;
        const scoreElement = document.getElementById("score");

        // åˆå§‹æ–¹å‘
        let d;

        // ç›£è½éµç›¤äº‹ä»¶
        document.addEventListener("keydown", direction);

        function direction(event) {
            let key = event.keyCode;
            // 37:å·¦, 38:ä¸Š, 39:å³, 40:ä¸‹
            // é˜²æ­¢è›‡ç›´æ¥å›é ­ (ä¾‹å¦‚å‘å³æ™‚ä¸èƒ½ç›´æ¥æŒ‰å·¦)
            if( key == 37 && d != "RIGHT"){
                d = "LEFT";
            } else if(key == 38 && d != "DOWN"){
                d = "UP";
            } else if(key == 39 && d != "LEFT"){
                d = "RIGHT";
            } else if(key == 40 && d != "UP"){
                d = "DOWN";
            }
        }

        // ç¢°æ’æª¢æ¸¬å‡½æ•¸
        function collision(head, array){
            for(let i = 0; i < array.length; i++){
                if(head.x == array[i].x && head.y == array[i].y){
                    return true;
                }
            }
            return false;
        }

        // ä¸»è¦ç¹ªåœ–èˆ‡é‚è¼¯å‡½æ•¸ (æ¯100æ¯«ç§’åŸ·è¡Œä¸€æ¬¡)
        function draw() {
            // 1. æ¸…ç©ºç•«å¸ƒ
            ctx.fillStyle = "#000";
            ctx.fillRect(0, 0, canvasSize, canvasSize);

            // 2. ç•«è›‡
            for( let i = 0; i < snake.length; i++){
                // é ­æ˜¯ç¶ è‰²ï¼Œèº«é«”æ˜¯ç™½è‰²
                ctx.fillStyle = ( i == 0 ) ? "#4CAF50" : "white"; 
                ctx.fillRect(snake[i].x, snake[i].y, box, box);
                
                // ç•«è›‡çš„é‚Šæ¡†ï¼Œè®“æ ¼å­æ¸…æ¥šä¸€é»
                ctx.strokeStyle = "#222";
                ctx.strokeRect(snake[i].x, snake[i].y, box, box);
            }

            // 3. ç•«é£Ÿç‰©
            ctx.fillStyle = "red";
            ctx.fillRect(food.x, food.y, box, box);

            // 4. è¨˜éŒ„è›‡é ­çš„ç›®å‰ä½ç½®
            let snakeX = snake[0].x;
            let snakeY = snake[0].y;

            // 5. æ ¹æ“šæ–¹å‘ç§»å‹•è›‡é ­
            if( d == "LEFT") snakeX -= box;
            if( d == "UP") snakeY -= box;
            if( d == "RIGHT") snakeX += box;
            if( d == "DOWN") snakeY += box;

            // 6. åˆ¤æ–·æ˜¯å¦åƒåˆ°é£Ÿç‰©
            if(snakeX == food.x && snakeY == food.y){
                score++;
                scoreElement.innerText = score;
                // é‡æ–°ç”Ÿæˆé£Ÿç‰©
                food = {
                    x: Math.floor(Math.random() * (canvasSize/box)) * box,
                    y: Math.floor(Math.random() * (canvasSize/box)) * box
                }
                // é€™è£¡ä¸åŸ·è¡Œ pop()ï¼Œè›‡å°±æœƒè®Šé•·
            } else {
                // æ²’åƒåˆ°é£Ÿç‰©ï¼Œç§»é™¤å°¾å·´ (ç§»å‹•æ•ˆæœ)
                snake.pop();
            }

            // 7. å»ºç«‹æ–°çš„è›‡é ­
            let newHead = {
                x : snakeX,
                y : snakeY
            }

            // 8. åˆ¤æ–·éŠæˆ²çµæŸ (æ’ç‰† æˆ– æ’è‡ªå·±)
            if(snakeX < 0 || snakeX >= canvasSize || snakeY < 0 || snakeY >= canvasSize || collision(newHead, snake)){
                clearInterval(game); // åœæ­¢éŠæˆ²è¿´åœˆ
                alert("ğŸ’€ éŠæˆ²çµæŸï¼\nä½ çš„å¾—åˆ†æ˜¯: " + score + "\né‡æ–°æ•´ç†ç¶²é å†ä¾†ä¸€æ¬¡ï¼");
            }

            // å°‡æ–°é ­åŠ å…¥é™£åˆ—æœ€å‰æ–¹
            snake.unshift(newHead);
        }

        // è¨­å®šéŠæˆ²é€Ÿåº¦ (100æ¯«ç§’æ›´æ–°ä¸€æ¬¡ç•«é¢)
        let game = setInterval(draw, 100);

    </script>
</body>
</html>